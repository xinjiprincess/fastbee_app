<page-meta><navigation-bar title="添加设备" title-align="center" background-color="#007AFF"></navigation-bar></page-meta><view class="container"><view class="card"><u--form class="vue-ref" vue-id="e2bb6784-1" labelPosition="left" model="{{form}}" rules="{{rules}}" labelWidth="80" labelAlign="center" data-ref="form" bind:__l="__l" vue-slots="{{['default']}}"><view style="padding:10px 0;border-bottom:1px solid #EFEFEF;display:flex;"><u--text vue-id="{{('e2bb6784-2')+','+('e2bb6784-1')}}" prefixIcon="grid-fill" iconStyle="font-size: 16px;color:#606266" text="第一步: 填写WIFI信息" bold="{{true}}" color="#606266" bind:__l="__l"></u--text></view><u-form-item vue-id="{{('e2bb6784-3')+','+('e2bb6784-1')}}" label="WIFI名称" prop="SSID" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('e2bb6784-4')+','+('e2bb6784-3')}}" placeholder="请输入WIFI名称" value="{{form.SSID}}" data-event-opts="{{[['^input',[['__set_model',['$0','SSID','$event',[]],['form']]]]]}}" bind:__l="__l"></u-input></u-form-item><u-form-item vue-id="{{('e2bb6784-5')+','+('e2bb6784-1')}}" label="WIFI密码" prop="password" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('e2bb6784-6')+','+('e2bb6784-5')}}" placeholder="请输入WIFI密码" type="{{passwordShow?'text':'password'}}" value="{{form.password}}" data-event-opts="{{[['^input',[['__set_model',['$0','password','$event',[]],['form']]]]]}}" bind:__l="__l" vue-slots="{{['suffix']}}"><view slot="suffix"><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" bindtap="__e"><block wx:if="{{!passwordShow}}"><u-icon vue-id="{{('e2bb6784-7')+','+('e2bb6784-6')}}" name="eye-off" size="24" color="#666" bind:__l="__l"></u-icon></block></view><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" bindtap="__e"><block wx:if="{{passwordShow}}"><u-icon vue-id="{{('e2bb6784-8')+','+('e2bb6784-6')}}" name="eye-fill" size="24" color="#666" bind:__l="__l"></u-icon></block></view></view></u-input></u-form-item><u-form-item vue-id="{{('e2bb6784-9')+','+('e2bb6784-1')}}" label=" " bind:__l="__l" vue-slots="{{['default']}}"><u-checkbox-group bind:input="__e" vue-id="{{('e2bb6784-10')+','+('e2bb6784-9')}}" value="{{checkboxConfigs}}" data-event-opts="{{[['^input',[['__set_model',['','checkboxConfigs','$event',[]]]]]]}}" bind:__l="__l" vue-slots="{{['default']}}"><u-checkbox vue-id="{{('e2bb6784-11')+','+('e2bb6784-10')}}" customStyle="{{({marginRight:'15px'})}}" label="记住密码" name="remeber" bind:__l="__l"></u-checkbox><u-checkbox vue-id="{{('e2bb6784-12')+','+('e2bb6784-10')}}" customStyle="{{$root.a0}}" label="高级" name="advance" bind:__l="__l"></u-checkbox></u-checkbox-group></u-form-item></u--form><block wx:if="{{$root.g0!=-1}}"><view><u--form class="vue-ref" vue-id="e2bb6784-13" labelPosition="left" model="{{form}}" rules="{{rules}}" labelWidth="80" labelAlign="center" labelStyle="{{({color:'#3fd1ad',fontSize:'14px'})}}" data-ref="form2" bind:__l="__l" vue-slots="{{['default']}}"><u-form-item vue-id="{{('e2bb6784-14')+','+('e2bb6784-13')}}" label="用户编号" prop="userId" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('e2bb6784-15')+','+('e2bb6784-14')}}" placeholder="请输入用户编号" disabled="{{userIdDisabled}}" value="{{form.userId}}" data-event-opts="{{[['^input',[['__set_model',['$0','userId','$event',[]],['form']]]]]}}" bind:__l="__l" vue-slots="{{['suffix']}}"><view slot="suffix"><view data-event-opts="{{[['tap',[['e2',['$event']]]]]}}" bindtap="__e"><block wx:if="{{userIdDisabled}}"><u-icon vue-id="{{('e2bb6784-16')+','+('e2bb6784-15')}}" name="lock-fill" size="24" color="#666" bind:__l="__l"></u-icon></block></view><view data-event-opts="{{[['tap',[['e3',['$event']]]]]}}" bindtap="__e"><block wx:if="{{!userIdDisabled}}"><u-icon vue-id="{{('e2bb6784-17')+','+('e2bb6784-15')}}" name="lock-opened-fill" size="24" color="#666" bind:__l="__l"></u-icon></block></view></view></u-input></u-form-item><u-form-item vue-id="{{('e2bb6784-18')+','+('e2bb6784-13')}}" label="设备编号" prop="deviceNum" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('e2bb6784-19')+','+('e2bb6784-18')}}" placeholder="请输入设备编号" value="{{form.deviceNum}}" data-event-opts="{{[['^input',[['__set_model',['$0','deviceNum','$event',[]],['form']]]]]}}" bind:__l="__l" vue-slots="{{['suffix']}}"><view slot="suffix"><u-icon vue-id="{{('e2bb6784-20')+','+('e2bb6784-19')}}" name="scan" color="#666" size="24" data-event-opts="{{[['^click',[['openScan']]]]}}" bind:click="__e" bind:__l="__l"></u-icon></view></u-input></u-form-item><u-form-item vue-id="{{('e2bb6784-21')+','+('e2bb6784-13')}}" label="授 权 码" prop="authCode" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('e2bb6784-22')+','+('e2bb6784-21')}}" placeholder="请输入授权码" value="{{form.authCode}}" data-event-opts="{{[['^input',[['__set_model',['$0','authCode','$event',[]],['form']]]]]}}" bind:__l="__l"></u-input></u-form-item><u-form-item vue-id="{{('e2bb6784-23')+','+('e2bb6784-13')}}" label="补充信息" prop="extra" bind:__l="__l" vue-slots="{{['default']}}"><u-textarea bind:input="__e" vue-id="{{('e2bb6784-24')+','+('e2bb6784-23')}}" height="40" fontSize="14" placeholder="请输入补充信息" confirmType="done" value="{{form.extra}}" data-event-opts="{{[['^input',[['__set_model',['$0','extra','$event',[]],['form']]]]]}}" bind:__l="__l"></u-textarea></u-form-item></u--form></view></block></view><view class="card"><view style="padding:10px 0;"><u--text vue-id="e2bb6784-25" prefixIcon="grid-fill" iconStyle="font-size: 16px;color:#606266" text="第二步: 设备进入配网模式" bold="{{true}}" color="#606266" bind:__l="__l"></u--text></view></view><view class="card"><view style="padding:0;border-bottom:1px solid #EFEFEF;display:flex;"><u--text vue-id="e2bb6784-26" prefixIcon="grid-fill" iconStyle="font-size: 16px;color:#606266" text="第三步: 配网" bold="{{true}}" color="#606266" bind:__l="__l"></u--text><view><u-tabs vue-id="e2bb6784-27" list="{{[{name:'单设备'},{name:'多设备'}]}}" current="{{tabIndex}}" scrollable="{{false}}" lineWidth="50" lineHeight="2" duration="{{100}}" data-event-opts="{{[['^click',[['tabClick']]]]}}" bind:click="__e" bind:__l="__l"></u-tabs></view></view><block wx:if="{{tabIndex==0}}"><view><view style="margin:30px 0 0 0;display:flex;"><u-steps vue-id="e2bb6784-28" current="{{step}}" direction="column" bind:__l="__l" vue-slots="{{['default']}}"><u-steps-item vue-id="{{('e2bb6784-29')+','+('e2bb6784-28')}}" title="设备进入配网模式" desc="设备会启动WIFI热点" bind:__l="__l"></u-steps-item><u-steps-item vue-id="{{('e2bb6784-30')+','+('e2bb6784-28')}}" title="手动连接设备热点" desc="手机连接设备WIFI热点" bind:__l="__l"></u-steps-item><u-steps-item vue-id="{{('e2bb6784-31')+','+('e2bb6784-28')}}" title="检测设备" desc="系统自动检测" bind:__l="__l"></u-steps-item><u-steps-item vue-id="{{('e2bb6784-32')+','+('e2bb6784-28')}}" title="配网结束" desc="手机可重新连接WIFI" bind:__l="__l"></u-steps-item></u-steps><view style="margin:0 auto;"><circle-progress vue-id="e2bb6784-33" percent="{{progress}}" borderWidth="12" width="260" bind:__l="__l" vue-slots="{{['default']}}"><view><text style="font-size:24px;display:block;">{{progress+"%"}}</text></view></circle-progress><view style="display:flex;"><block wx:if="{{step<2}}"><u-loading-icon vue-id="e2bb6784-34" customStyle="width:30px;margin-left:10px;" size="12" bind:__l="__l"></u-loading-icon></block><u--text vue-id="e2bb6784-35" text="{{count.text}}" type="{{count.type}}" size="12" customStyle="{{step<2?'':'margin:0 auto;'}}" bind:__l="__l"></u--text></view></view></view><block wx:if="{{step<3}}"><view style="padding:30px 10px;"><u-button vue-id="e2bb6784-36" text="开始配网" type="primary" disabled="{{step<2}}" data-event-opts="{{[['^click',[['beginConfig']]]]}}" bind:click="__e" bind:__l="__l"></u-button></view></block><block wx:if="{{step==4}}"><view style="padding:30px 10px;"><u-button vue-id="e2bb6784-37" text="重新配网" type="warning" data-event-opts="{{[['^click',[['restartConfig']]]]}}" bind:click="__e" bind:__l="__l"></u-button></view></block><block wx:if="{{step==3}}"><view style="padding:30px 10px;"><u-button vue-id="e2bb6784-38" text="手机重连Wifi后, 返回查看" type="primary" data-event-opts="{{[['^click',[['goBack']]]]}}" bind:click="__e" bind:__l="__l"></u-button></view></block></view></block><block wx:if="{{tabIndex==1}}"><view><view style="margin:20px 0 0 10px;"><u--text vue-id="e2bb6784-39" type="warning" text="提示：多设备配网目前只支持微信小程序, 需要启用手机Wifi开关" size="12" bind:__l="__l"></u--text></view><uni-table class="vue-ref" style="margin-top:10px;" vue-id="e2bb6784-40" loading="{{loading}}" emptyText="暂无更多数据" data-ref="table" bind:__l="__l" vue-slots="{{['default']}}"><uni-tr vue-id="{{('e2bb6784-41')+','+('e2bb6784-40')}}" bind:__l="__l" vue-slots="{{['default']}}"><uni-th vue-id="{{('e2bb6784-42')+','+('e2bb6784-41')}}" bind:__l="__l" vue-slots="{{['default']}}"><view style="display:flex;width:100%;"><view style="flex:1;"><u--text vue-id="{{('e2bb6784-43')+','+('e2bb6784-42')}}" size="15" color="#606266" lines="1" text="请选择设备热点" bind:__l="__l"></u--text></view><view style="width:40px;"><u-button vue-id="{{('e2bb6784-44')+','+('e2bb6784-42')}}" text="刷新" disabled="{{!isWeChat||updateDisable}}" size="mini" type="primary" data-event-opts="{{[['^click',[['updateWfifiListInWeChat']]]]}}" bind:click="__e" bind:__l="__l"></u-button></view></view></uni-th></uni-tr><block wx:for="{{wifiList}}" wx:for-item="wifi" wx:for-index="index" wx:key="index"><uni-tr vue-id="{{('e2bb6784-45-'+index)+','+('e2bb6784-40')}}" bind:__l="__l" vue-slots="{{['default']}}"><block wx:if="{{wifi.signalStrength>0}}"><uni-td vue-id="{{('e2bb6784-46-'+index)+','+('e2bb6784-45-'+index)}}" bind:__l="__l" vue-slots="{{['default']}}"><view data-event-opts="{{[['tap',[['selectChange',['$0'],[[['wifiList','',index]]]]]]]}}" bindtap="__e"><view style="display:flex;margin:-10px;padding:10px 0;"><view style="width:35px;align-self:center;"><checkbox style="transform:scale(0.8);" checked="{{wifi.checked}}" color="#3c9cff"></checkbox></view><view style="flex:1;"><view style="display:flex;line-height:30px;align-items:center;"><view style="flex:1;"><u--text vue-id="{{('e2bb6784-47-'+index)+','+('e2bb6784-46-'+index)}}" size="14" color="{{wifi.secure?'#999':'#3c9cff'}}" text="{{wifi.SSID}}" bind:__l="__l"></u--text></view><view style="margin-right:10px;"><block wx:if="{{wifi.signalStrength>0&&wifi.signalStrength<25}}"><u-icon vue-id="{{('e2bb6784-48-'+index)+','+('e2bb6784-46-'+index)}}" name="/static/wifi_1.png" size="14" bind:__l="__l"></u-icon></block><block wx:if="{{wifi.signalStrength>=25&&wifi.signalStrength<50}}"><u-icon vue-id="{{('e2bb6784-49-'+index)+','+('e2bb6784-46-'+index)}}" name="/static/wifi_2.png" size="14" bind:__l="__l"></u-icon></block><block wx:if="{{wifi.signalStrength>=50&&wifi.signalStrength<75}}"><u-icon vue-id="{{('e2bb6784-50-'+index)+','+('e2bb6784-46-'+index)}}" name="/static/wifi_3.png" size="14" bind:__l="__l"></u-icon></block><block wx:if="{{wifi.signalStrength>=75&&wifi.signalStrength<=100}}"><u-icon vue-id="{{('e2bb6784-51-'+index)+','+('e2bb6784-46-'+index)}}" name="/static/wifi_4.png" size="14" bind:__l="__l"></u-icon></block></view></view><block wx:if="{{wifi.checked==true}}"><view style="display:flex;"><view style="width:100%;margin-top:6px;"><u-line-progress vue-id="{{('e2bb6784-52-'+index)+','+('e2bb6784-46-'+index)}}" percentage="{{wifi.process}}" activeColor="#3c9cff" bind:__l="__l"></u-line-progress></view><view style="width:70px;margin-left:6px;"><u--text vue-id="{{('e2bb6784-53-'+index)+','+('e2bb6784-46-'+index)}}" size="12" text="{{wifi.text}}" type="{{wifi.type}}" bind:__l="__l"></u--text></view></view></block></view></view></view></uni-td></block></uni-tr></block></uni-table><block wx:if="{{mstep==0}}"><view style="padding:20px 10px;"><u-button vue-id="e2bb6784-54" text="开始配网" type="primary" disabled="{{!isWeChat}}" data-event-opts="{{[['^click',[['beginConfigInWeChart']]]]}}" bind:click="__e" bind:__l="__l"></u-button></view></block><block wx:if="{{mstep==1}}"><view style="padding:20px 10px;"><u-button vue-id="e2bb6784-55" text="配网中..." type="primary" loading="{{true}}" bind:__l="__l"></u-button></view></block><block wx:if="{{mstep==2}}"><view style="padding:20px 10px;"><u-button vue-id="e2bb6784-56" text="正在连接网络..." type="primary" loading="{{true}}" bind:__l="__l"></u-button></view></block><block wx:if="{{mstep==3}}"><view style="padding:20px 10px;"><u-button vue-id="e2bb6784-57" text="返回查看" type="primary" data-event-opts="{{[['^click',[['goBack']]]]}}" bind:click="__e" bind:__l="__l"></u-button></view></block></view></block></view></view>